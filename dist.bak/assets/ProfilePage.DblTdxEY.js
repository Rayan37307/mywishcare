import{f as N,g as v,a as w,r as i,j as e}from"./index.rlwCrqap.js";const k=()=>{const{user:r,isAuthenticated:n,logout:u}=N(),{orders:c,loading:x,error:h,fetchOrders:g,fetchOrder:j}=v(),{items:m,totalPrice:f}=w(),[l,d]=i.useState("orders"),[t,p]=i.useState(null),[y,o]=i.useState(!1);return i.useEffect(()=>{const s=()=>{const a=window.location.hash;a==="#orders"||a==="#profile"?d("orders"):a==="#cart"&&d("cart")};return s(),window.addEventListener("hashchange",s),()=>{window.removeEventListener("hashchange",s)}},[]),i.useEffect(()=>{n&&r&&g()},[n,r]),!n||!r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"max-w-md w-full space-y-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Access Denied"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Please log in to view your profile."})]})})}):!r.displayName&&!r.username?(console.error("User object missing required fields:",r),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Profile Error"}),e.jsx("p",{className:"text-gray-600",children:"User data is incomplete. Please try logging out and in again."})]})})):e.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-6 border-b border-gray-100 bg-gradient-to-r from-blue-50 to-indigo-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-14 w-14 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white shadow-lg",children:e.jsx("span",{className:"text-xl font-bold",children:r.displayName?.charAt(0)?.toUpperCase()||r.username?.charAt(0)?.toUpperCase()||"U"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h1",{className:"text-xl leading-6 font-bold text-gray-900",children:r.displayName||r.username}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.email||"No email"})]})]}),e.jsx("button",{onClick:u,className:"text-sm bg-red-50 hover:bg-red-100 text-red-600 px-4 py-2 rounded-lg transition-colors duration-200 font-medium",children:"Sign Out"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-4 -mb-px",children:[e.jsxs("button",{onClick:()=>d("orders"),className:`${l==="orders"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:["Orders (",c.length,")"]}),e.jsxs("button",{onClick:()=>d("cart"),className:`${l==="cart"?"border-indigo-500 text-indigo-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm`,children:["Cart (",m.length,")"]})]})}),e.jsxs("div",{className:"p-6",children:[l==="orders"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Order History"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"View your past orders and their status."})]}),e.jsx("button",{onClick:g,disabled:x,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:x?"Refreshing...":"Refresh Orders"})]}),x?e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mx-auto"})}):h?e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:[e.jsx("strong",{className:"font-bold",children:"Error: "}),e.jsx("span",{className:"block sm:inline",children:h})]}):c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"No orders found."}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Your orders will appear here after you place them."})]}):e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:c.map(s=>e.jsx("li",{children:e.jsxs("div",{className:"px-4 py-4 sm:px-6 hover:bg-gray-50 cursor-pointer",onClick:async()=>{try{await j(s.id),p(s),o(!0)}catch(a){console.error("Error fetching order details:",a),p(s),o(!0)}},children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm font-medium text-indigo-600 truncate",children:["Order #",s.id]}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="processing"?"bg-yellow-100 text-yellow-800":s.status==="on-hold"?"bg-orange-100 text-orange-800":s.status==="cancelled"?"bg-red-100 text-red-800":s.status==="refunded"?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:s.status.replace("-"," ").toUpperCase()})})]}),e.jsxs("div",{className:"mt-2 sm:flex sm:justify-between",children:[e.jsxs("div",{className:"sm:flex",children:[e.jsx("div",{className:"mr-6 text-sm text-gray-500",children:new Date(s.date_created).toLocaleDateString()}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:["Items: ",s.line_items.reduce((a,b)=>a+b.quantity,0)]})]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-900 font-medium sm:mt-0",children:[s.total," ",s.currency]})]})]})},s.id))})})]}),l==="cart"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Shopping Cart"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"View and manage your cart items."})]}),m.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"Your cart is empty."})}):e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:[e.jsx("ul",{className:"divide-y divide-gray-200",children:m.map(s=>e.jsx("li",{children:e.jsx("div",{className:"px-4 py-4 sm:px-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-16 w-16",children:e.jsx("img",{className:"h-16 w-16 rounded-md object-cover",src:s.product.images?.[0]?.src||"/placeholder-image.jpg",alt:s.product.images?.[0]?.alt||s.product.name})}),e.jsxs("div",{className:"ml-4 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:s.product.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Qty: ",s.quantity]})]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["$",parseFloat(String(s.product.price||"0")).toFixed(2)," each"]})]}),e.jsxs("div",{className:"ml-4 text-sm font-medium text-gray-900",children:["$",(parseFloat(String(s.product.price||"0"))*s.quantity).toFixed(2)]})]})})},s.product.id))}),e.jsxs("div",{className:"bg-gray-50 px-4 py-4 sm:px-6 flex justify-between items-center",children:[e.jsxs("div",{className:"text-lg font-medium text-gray-900",children:["Total: $",f.toFixed(2)]}),e.jsx("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:()=>window.location.hash="#/checkout",children:"Checkout"})]})]})]})]})]})}),y&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Order Details"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("span",{className:"text-2xl",children:"Ã—"})})]}),e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Order ID"}),e.jsxs("p",{className:"font-medium",children:["#",t.id]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),e.jsx("p",{className:"font-medium",children:new Date(t.date_created).toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:`font-medium ${t.status==="completed"?"text-green-600":t.status==="processing"?"text-yellow-600":t.status==="on-hold"?"text-orange-600":t.status==="cancelled"?"text-red-600":t.status==="refunded"?"text-purple-600":"text-gray-600"}`,children:t.status.replace("-"," ").toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total"}),e.jsxs("p",{className:"font-medium",children:[t.total," ",t.currency]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium mt-4",children:"Items"}),e.jsx("ul",{className:"mt-2 space-y-2",children:t.line_items?.map((s,a)=>e.jsxs("li",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[s.name," (Qty: ",s.quantity,")"]}),e.jsx("span",{children:s.total})]},a))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium",children:"Billing Address"}),e.jsxs("p",{className:"text-sm mt-1",children:[t.billing?.first_name," ",t.billing?.last_name,e.jsx("br",{}),t.billing?.address_1,e.jsx("br",{}),t.billing?.address_2&&e.jsxs(e.Fragment,{children:[t.billing.address_2,e.jsx("br",{})]}),t.billing?.city,", ",t.billing?.state," ",t.billing?.postcode,e.jsx("br",{}),t.billing?.country,e.jsx("br",{}),t.billing?.email,e.jsx("br",{}),t.billing?.phone]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium",children:"Shipping Address"}),e.jsxs("p",{className:"text-sm mt-1",children:[t.shipping?.first_name," ",t.shipping?.last_name,e.jsx("br",{}),t.shipping?.address_1,e.jsx("br",{}),t.shipping?.address_2&&e.jsxs(e.Fragment,{children:[t.shipping.address_2,e.jsx("br",{})]}),t.shipping?.city,", ",t.shipping?.state," ",t.shipping?.postcode,e.jsx("br",{}),t.shipping?.country]})]})]})]})]})})})]})};export{k as default};
